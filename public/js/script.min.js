$(document).ready(function(){function e(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(a){$(".error.message.photo").hide();$(".photo_upload").addClass("load");$(".photo_upload").attr("src",a.target.result)};b.readAsDataURL(a.files[0])}}$(".ui.dropdown").dropdown();$(".ui.dimmer").dimmer({on:"hover"});0!=$(".test").length&&($(".login.modal").modal("setting",{onHidden:function(){window.location.href="/home"}}).modal("show"),$("#login_form .ui.error.message").show());var d={inline:!0,
on:"submit",onSuccess:function(){$.ajax({url:"register",type:"POST",data:$("#register_form").serialize(),success:function(a){"inject"!=a?window.location.href="/profile/"+a:$("#register_form .error.message").html("\u7dbd\u865f\u8acb\u4e0d\u8981\u4f7f\u7528\u7279\u6b8a\u5b57\u5143(\u4e0d\u7528inject\u6211\u5011...)").show()},error:function(){alert("wrong")}})}},f={nickname:{identifier:"nickname",rules:[{type:"empty",prompt:"\u9084\u6c92\u8f38\u5165\u7dbd\u865f\u5537!!"}]},account:{identifier:"account",
rules:[{type:"empty",prompt:"\u9084\u6c92\u8f38\u5165Email\u5537!!"},{type:"email",prompt:"\u8acb\u4f7f\u7528\u6709\u6548\u7684Email!!"}]},password:{identifier:"password",rules:[{type:"empty",prompt:"\u9084\u6c92\u8f38\u5165\u5bc6\u78bc\u5537!!"},{type:"length[4]",prompt:"\u81f3\u5c11\u9700\u89814\u4f4d\u5bc6\u78bc!!"}]},password_again:{identifier:"password-again",rules:[{type:"empty",prompt:"\u8acb\u518d\u8f38\u5165\u4e00\u6b21\u5bc6\u78bc!!"},{type:"match[password]",prompt:"\u5169\u6b21\u5bc6\u78bc\u4e0d\u4e00\u81f4\uff0c\u8acb\u518d\u8f38\u5165\u4e00\u6b21!!"}]}};
$(".userList img").popup({on:"click",inline:!0});$(".ui.checkbox").checkbox();$("a.item.register").click(function(){$(".register.modal").modal("show")});$("a.item.login").click(function(){$(".login.modal").modal("setting",{onHidden:function(){$("#login_form .error.message").hide()}}).modal("show")});$("#login_form .button.ok").click(function(){$.ajax({url:"login",type:"POST",data:$("#login_form").serialize(),success:function(a){"\u5e33\u865for\u5bc6\u78bc\u8f38\u5165\u932f\u8aa4"!=a?window.location.href=
"/user/"+a:$("#login_form .error.message").html(a).show()},error:function(){alert("wrong")}})});$(".upload").change(function(){e(this)});$("#modify_form .button.ok").click(function(){var a=$("#modify_form").attr("user");$.ajax({url:"/profile/"+a,type:"put",data:$("#modify_form").serialize(),enctype:"multipart/form-data",success:function(b){"inject"==b?$("#modify_form .error.message").html("\u7dbd\u865f\u8acb\u4e0d\u8981\u4f7f\u7528\u7279\u6b8a\u5b57\u5143(\u4e0d\u7528inject\u6211\u5011...)").show():
"upload_ok"==b?window.location.href="/profile/"+a:console.log(b)},error:function(){alert("wrong")}})});$("#register_form .ui.form").form(f,d);$(".profie-btn.post").click(function(){$(".creatework.modal").modal("show")});$("#register_form .ui.form").form(f,d);$(".profile-btn.post").click(function(){$(".creatework.modal").modal("show")});$("#datepick").datepicker();$("#datepick").datepicker("option","dateFormat","yy-mm-dd");$("#task_form .black.submit.button").click(function(){if(""==$('#task_form input[name="workName"').val())return $("#task_form .error.message").html("\u8acb\u8f38\u5165\u5de5\u4f5c\u540d\u7a31").show(),
!1;if(""==$('#task_form input[name="description"').val())return $("#task_form .error.message").html("\u8acb\u8f38\u5165\u5de5\u4f5c\u6558\u8ff0").show(),!1;if(""==$('#task_form input[name="reward"').val())return $("#task_form .error.message").html("\u8acb\u8f38\u5165\u5de5\u4f5c\u734e\u8cde").show(),!1;if(""==$('#task_form input[name="date"').val())return $("#task_form .error.message").html("\u8acb\u8f38\u5165\u5de5\u4f5c\u6642\u9593").show(),!1;var a=new FormData($("#task_form")[0]);console.log("ok");
$.ajax({url:"/work",type:"POST",data:a,async:!1,success:function(a){"inject"==a?$("#task_form .error.message").html("\u5de5\u4f5c\u540d\u7a31\u6216\u734e\u8cde\u8acb\u4e0d\u8981\u4f7f\u7528\u7279\u6b8a\u5b57\u5143(\u4e0d\u7528inject\u6211\u5011...)").show():"img_format"==a?$("#task_form .error.message").html("\u8acb\u4f7f\u7528\u6b63\u78ba\u7684\u5716\u7247\u683c\u5f0f\uff01").show():"img_empty"==a?$("#task_form .error.message").html("\u8acb\u4e0a\u50b3\u5716\u7247\uff01").show():window.location.href=
"/user/"+a},error:function(){alert("wrong")},cache:!1,contentType:!1,processData:!1})});$(".userList img").click(function(){$(".userList").children("img").each(function(){$(this).removeClass("active")});$(this).addClass("active")});$(".ui.green.button.choose-user").click(function(){var a,b;$(".userList").children("img").each(function(){$(this).hasClass("active")&&(a=$(this).attr("name"),b=$(this).attr("work-id"))});"undefined"==typeof a?alert("\u81f3\u5c11\u9078\u4e00\u500b\uff01\uff01"):$.ajax({url:"confirmtask",
type:"POST",data:{user:a,work:b},success:function(a){window.location.href="/user/"+a},error:function(){alert("wrong")}})});$(".ui.animated.black.button.go").click(function(){$("#filter_form").submit()})});$(function(){});
$(function(){$("#preview-coverflow").coverflow({index:4,density:2,innerOffset:30,innerScale:.8,innerAngle:-30,outerAngle:-30,duration:1E3,animateStep:function(e,d,f,a,b,c,g){a&&(b?$(d).css({filter:"none","-webkit-filter":"none"}):(e=1+Math.abs(c),c="contrast("+(1-Math.abs(c))+") brightness("+e+")",$(d).css({filter:c,"-webkit-filter":c})))}})});
